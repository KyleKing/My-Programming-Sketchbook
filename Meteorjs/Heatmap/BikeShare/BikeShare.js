// Version 2

DailyBikeData = new Mongo.Collection('dailyBikeData');

if (Meteor.isServer) {
  // Create Bike GPS coordinates
  function randGPS() {
    // Set bounding constraints
    var bottomLng = -76.936569; var topLng = -76.950603;
    var leftLat = 38.994052; var rightLat = 38.981376;
    var TypeConvFactor = 1000000; // To account for the int based getRandomArbitrary function

    // Create random coordinates
    function getRandomArbitrary(min, max) { return Math.random() * (max - min) + min; }
    var randCoordinates = {
      lat: (getRandomArbitrary(leftLat*TypeConvFactor, rightLat*TypeConvFactor) / TypeConvFactor),
      lng: (getRandomArbitrary(bottomLng*TypeConvFactor, topLng*TypeConvFactor) / TypeConvFactor)
    };
    return randCoordinates;
  };

  // Insert data into the database
  if (DailyBikeData.find().count() === 0) {
    var i = 1;
    while (i <= 2) {
      var randCoordinates = randGPS();
      DailyBikeData.insert({
        Bike: i,
        Tag: Math.round(0.65 * Math.random()) === 0 ? 'Available' : 'In Use',
        Positions: {
          lat: randCoordinates.lat,
          lng: randCoordinates.lng
        }
      });
      i++;
    }
    console.log('Created DailyBikeData data schema');
  }
}


// Version 3

if (Meteor.isClient) {
  Template.map.rendered = function() {
    // Create the Leaflet Map
    L.Icon.Default.imagePath = 'packages/bevanhunt_leaflet/images';
    var map = new L.Map('BikeMap', { center: new L.LatLng(38.987701, -76.940989) });
    L.tileLayer.provider('OpenStreetMap.Mapnik').addTo(map);
    map.spin(false);

    var data = [
      [-48,38.985908,-76.944213,95.70,20483900],
      [-35,38.985908,-76.944213,95.70,20483900],
      [-63,38.985908,-76.944213,95.50,20484500],
      [-45,38.985908,-76.944213,95.50,20484500],
      [-43,38.985908,-76.944213,95.50,20484500],
      [-43,38.985912,-76.944213,95.40,20484900],
      [-49,38.985912,-76.944213,95.40,20484900],
      [-49,38.985916,-76.944213,95.30,20485200],
      [-49,38.985916,-76.944213,95.30,20485200],
      [-43,38.985916,-76.944213,95.30,20485200],
      [-46,38.985916,-76.944213,95.30,20485200],
      [-47,38.985939,-76.944236,93.30,20485700],
      [-47,38.985939,-76.944236,93.30,20485700],
      [-38,38.985939,-76.944236,93.30,20485700],
      [-56,38.985939,-76.944236,93.30,20485700],
      [-63,38.985939,-76.944236,93.30,20485700],
      [-76,38.985939,-76.944244,93.10,20490300],
      [-73,38.985939,-76.944244,93.10,20490300],
      [-64,38.985939,-76.944244,93.10,20490300],
      [-70,38.985939,-76.944244,93.10,20490300],
      [-74,38.985939,-76.944252,93.10,20490800],
      [-72,38.985939,-76.944252,93.10,20490800],
      [-72,38.985939,-76.944252,93.10,20490800],
      [-74,38.985939,-76.944252,93.10,20490800],
      [-82,38.985942,-76.944252,93.00,20491300],
      [-80,38.985942,-76.944252,93.00,20491300],
      [-68,38.985942,-76.944252,93.00,20491300],
      [-79,38.985942,-76.944252,93.00,20491300],
      [-77,38.985946,-76.944252,92.90,20491800],
      [-67,38.985946,-76.944252,92.90,20491800],
      [-54,38.985946,-76.944252,92.90,20491800],
      [-61,38.985946,-76.944252,92.90,20491800],
      [-59,38.985954,-76.944252,92.70,20492300],
      [-69,38.985954,-76.944252,92.70,20492300],
      [-60,38.985954,-76.944252,92.70,20492300],
      [-52,38.985961,-76.944259,91.90,20492700],
      [-60,38.985961,-76.944259,91.90,20492700],
      [-52,38.985961,-76.944259,91.90,20492700],
      [-63,38.985961,-76.944259,91.90,20492700],
      [-61,38.985973,-76.944267,90.30,20493200],
      [-56,38.985973,-76.944267,90.30,20493200],
      [-57,38.985973,-76.944267,90.30,20493200],
      [-51,38.985973,-76.944267,90.30,20493200],
      [-45,38.985973,-76.944267,90.20,20493700],
      [-64,38.985973,-76.944267,90.20,20493700],
      [-71,38.985973,-76.944267,90.20,20493700],
      [-73,38.985973,-76.944267,90.20,20493700],
      [-61,38.985973,-76.944267,90.10,20494200],
      [-75,38.985973,-76.944267,90.10,20494200],
      [-61,38.985973,-76.944267,90.00,20494400],
      [-72,38.985973,-76.944267,90.00,20494400],
      [-59,38.985973,-76.944267,89.90,20494700],
      [-69,38.985973,-76.944267,89.90,20494700],
      [-65,38.985969,-76.944259,89.80,20495000],
      [-50,38.985969,-76.944259,89.80,20495000],
      [-51,38.985969,-76.944259,89.80,20495000],
      [-60,38.985965,-76.944259,89.70,20495400],
      [-81,38.985965,-76.944259,89.70,20495400],
      [-69,38.985965,-76.944259,89.70,20495400],
      [-61,38.985980,-76.944274,88.60,20495800],
      [-53,38.985980,-76.944274,88.60,20495800],
      [-59,38.985980,-76.944274,88.60,20495800],
      [-68,38.985980,-76.944274,88.60,20495800],
      [-70,38.985973,-76.944328,84.70,20500300],
      [-75,38.985973,-76.944328,84.70,20500300],
      [-77,38.985973,-76.944328,84.70,20500300],
      [-76,38.985973,-76.944328,84.70,20500300],
      [-71,38.985958,-76.944374,79.90,20500800],
      [-85,38.985958,-76.944374,79.90,20500800],
      [-66,38.985958,-76.944374,79.90,20500800],
      [-78,38.985965,-76.944404,77.20,20501200],
      [-73,38.985965,-76.944404,77.20,20501200],
      [-74,38.985965,-76.944404,77.20,20501200],
      [-77,38.985996,-76.944419,77.20,20501500],
      [-64,38.985996,-76.944419,77.20,20501500],
      [-63,38.986015,-76.944419,73.90,20501800],
      [-64,38.986015,-76.944419,73.90,20501800],
      [-63,38.986015,-76.944419,73.90,20501800],
      [-67,38.986015,-76.944419,73.90,20501800],
      [-59,38.986183,-76.943748,27.60,20580500],
      [-57,38.986183,-76.943748,27.60,20581000],
      [-61,38.986183,-76.943748,27.60,20581000],
      [-61,38.986183,-76.943748,27.60,20581000],
      [-61,38.986183,-76.943748,27.60,20581400],
      [-60,38.986183,-76.943748,27.60,20581400],
      [-67,38.986183,-76.943748,27.60,20581700],
      [-57,38.986183,-76.943748,27.60,20581700],
      [-68,38.986183,-76.943748,27.60,20581700],
      [-67,38.986183,-76.943748,27.60,20581700],
      [-72,38.986186,-76.943748,27.60,20582200],
      [-68,38.986186,-76.943748,27.60,20582200],
      [-70,38.986186,-76.943748,27.60,20582400],
      [-72,38.986186,-76.943748,27.60,20582400],
      [-74,38.986186,-76.943748,27.60,20582700],
      [-73,38.986186,-76.943748,27.60,20582700],
      [-76,38.986186,-76.943748,27.60,20582900],
      [-68,38.986186,-76.943748,27.60,20582900],
      [-70,38.986186,-76.943748,27.60,20583200],
      [-65,38.986186,-76.943748,27.60,20583200],
      [-80,38.986183,-76.943748,27.60,20583500],
      [-60,38.985786,-76.943618,28.00,21003300],
      [-63,38.985786,-76.943618,28.00,21003300],
      [-53,38.985786,-76.943618,28.00,21003300],
      [-62,38.985786,-76.943618,28.00,21003300],
      [-54,38.985782,-76.943618,28.00,21003800],
      [-57,38.985782,-76.943618,28.00,21003800],
      [-54,38.985782,-76.943618,28.00,21003800],
      [-62,38.985782,-76.943618,28.00,21003800],
      [-62,38.985794,-76.943618,28.00,21004300],
      [-68,38.986179,-76.943611,25.60,21020100],
      [-69,38.986179,-76.943611,25.60,21020100],
      [-75,38.986186,-76.943611,25.60,21020400],
      [-71,38.986186,-76.943611,25.60,21020400],
      [-79,38.986186,-76.943611,25.60,21020400],
      [-75,38.986228,-76.943603,25.40,21020800],
      [-76,38.986228,-76.943603,25.40,21020800],
      [-69,38.986228,-76.943603,25.40,21020800],
      [-68,38.986228,-76.943603,25.40,21020800],
      [-63,38.986286,-76.943603,25.20,21021300],
      [-66,38.986286,-76.943603,25.20,21021300],
      [-76,38.986286,-76.943603,25.20,21021300],
      [-62,38.986286,-76.943603,25.20,21021300],
      [-65,38.986339,-76.943603,25.30,21021800],
      [-72,38.986339,-76.943603,25.30,21021800],
      [-75,38.986339,-76.943603,25.30,21021800],
      [-72,38.986339,-76.943603,25.30,21021800],
      [-65,38.986358,-76.943611,25.60,21022300],
      [-60,38.986358,-76.943611,25.60,21022300],
      [-61,38.986358,-76.943611,25.60,21022300],
      [-55,38.986358,-76.943611,25.60,21022300],
      [-55,38.986305,-76.943458,0.00,21041200],
      [-57,38.986305,-76.943458,0.00,21041200],
      [-60,38.986301,-76.943466,29.30,21041500],
      [-60,38.986301,-76.943466,29.30,21041500],
      [-57,38.986301,-76.943466,29.30,21041500],
      [-62,38.986251,-76.943450,29.60,21041900],
      [-60,38.986251,-76.943450,29.60,21041900],
      [-74,38.986251,-76.943450,29.60,21041900],
      [-73,38.986198,-76.943435,29.50,21042300],
      [-64,38.986198,-76.943435,29.50,21042300],
      [-67,38.986198,-76.943435,29.50,21042300],
      [-80,38.986198,-76.943435,29.50,21042300],
      [-60,38.986145,-76.943443,29.40,21042800],
      [-79,38.986145,-76.943443,29.40,21042800],
      [-72,38.986145,-76.943443,29.40,21042800],
      [-67,38.986106,-76.943466,29.40,21043200],
      [-67,38.986106,-76.943466,29.40,21043200],
      [-57,38.986106,-76.943466,29.40,21043200],
      [-56,38.986106,-76.943466,29.40,21043200],
      [-61,38.986106,-76.943466,29.40,21043200],
      [-57,38.986045,-76.943481,29.20,21043800],
      [-66,38.986045,-76.943481,29.20,21043800],
      [-69,38.986045,-76.943481,29.20,21043800],
      [-66,38.986000,-76.943489,29.00,21044200],
      [-61,38.986000,-76.943489,29.00,21044200],
      [-75,38.986000,-76.943489,29.00,21044200],
      [-67,38.986000,-76.943489,29.00,21044200],
      [-74,38.985942,-76.943473,28.60,21044700],
      [-67,38.985942,-76.943473,28.60,21044700],
      [-69,38.985942,-76.943473,28.60,21044700],
      [-71,38.985942,-76.943473,28.60,21044700],
      [-65,38.985889,-76.943481,29.10,21045200],
      [-72,38.985889,-76.943481,29.10,21045200],
      [-64,38.985889,-76.943481,29.10,21045200],
      [-66,38.985889,-76.943481,29.10,21045200],
      [-72,38.985889,-76.943481,29.10,21045200],
      [-68,38.985828,-76.943473,28.60,21045800],
      [-73,38.985828,-76.943473,28.60,21045800],
      [-81,38.985828,-76.943473,28.60,21045800],
      [-74,38.985828,-76.943473,28.60,21045800],
      [-74,38.985767,-76.943466,28.40,21050300],
      [-74,38.985767,-76.943466,28.40,21050300],
      [-73,38.985767,-76.943466,28.40,21050300],
      [-63,38.985767,-76.943466,28.40,21050300],
      [-72,38.985710,-76.943473,28.50,21050800],
      [-72,38.985710,-76.943473,28.50,21050800],
      [-69,38.985710,-76.943473,28.50,21050800],
      [-55,38.985710,-76.943473,28.50,21050800],
      [-59,38.985656,-76.943481,28.30,21051300],
      [-67,38.986049,-76.942939,27.40,21083800],
      [-67,38.986049,-76.942939,27.40,21083800],
      [-67,38.986049,-76.942939,27.40,21083800],
      [-65,38.986034,-76.942939,27.30,21084200],
      [-70,38.986034,-76.942939,27.30,21084200],
      [-67,38.986034,-76.942939,27.30,21084200],
      [-64,38.986034,-76.942939,27.30,21084200],
      [-80,38.985980,-76.942932,26.90,21084700],
      [-63,38.985980,-76.942932,26.90,21084700],
      [-76,38.985980,-76.942932,26.90,21084700],
      [-72,38.985980,-76.942932,26.90,21084700],
      [-80,38.985923,-76.942932,26.80,21085200],
      [-75,38.985923,-76.942932,26.80,21085200],
      [-83,38.985923,-76.942932,26.80,21085200],
      [-76,38.985923,-76.942932,26.80,21085200],
      [-76,38.985923,-76.942932,26.80,21085200],
      [-73,38.985858,-76.942924,26.80,21085800],
      [-69,38.985858,-76.942924,26.80,21085800],
      [-60,38.985858,-76.942924,26.80,21085800],
      [-65,38.985816,-76.942916,27.00,21090200],
      [-68,38.985816,-76.942916,27.00,21090200],
      [-76,38.985816,-76.942916,27.00,21090200],
      [-66,38.985816,-76.942916,27.00,21090200],
      [-68,38.985755,-76.942924,27.50,21090700],
      [-81,38.985755,-76.942924,27.50,21090700],
      [-78,38.985755,-76.942924,27.50,21090700],
      [-66,38.985755,-76.942924,27.50,21090700],
      [-74,38.985694,-76.942916,27.90,21091200],
      [-80,38.985694,-76.942916,27.90,21091200],
      [-77,38.985668,-76.942924,28.00,21091500],
      [-79,38.985668,-76.942924,28.00,21091500],
      [-71,38.985668,-76.942924,28.00,21091500],
      [-87,38.985668,-76.942924,28.00,21091500],
      [-83,38.985610,-76.942916,28.30,21092000],
      [-89,38.985610,-76.942916,28.30,21092000],
      [-84,38.985576,-76.942916,28.40,21092300],
      [-81,38.985576,-76.942916,28.40,21092300],
      [-87,38.985576,-76.942916,28.40,21092300],
      [-84,38.985576,-76.942916,28.40,21092300],
      [-83,38.985530,-76.942909,28.30,21092800],
      [-77,38.985530,-76.942909,28.30,21092800],
      [-78,38.985530,-76.942909,28.30,21092800],
      [-80,38.985530,-76.942909,28.30,21092800],
      [-78,38.985504,-76.942855,28.00,21093300],
      [-78,38.985504,-76.942855,28.00,21093300],
      [-81,38.985504,-76.942855,28.00,21093300],
      [-70,38.985488,-76.942794,27.70,21093700],
      [-82,38.985488,-76.942794,27.70,21093700],
      [-85,38.985488,-76.942794,27.70,21093700],
      [-82,38.985488,-76.942794,27.70,21093700],
      [-77,38.985477,-76.942749,27.30,21094200],
      [-71,38.985477,-76.942749,27.30,21094200],
      [-73,38.985477,-76.942749,27.30,21094200],
      [-83,38.985477,-76.942749,27.30,21094200],
      [-78,38.985469,-76.942687,27.00,21094700],
      [-71,38.985469,-76.942687,27.00,21094700],
      [-68,38.985481,-76.942626,26.80,21095200],
      [-75,38.985481,-76.942626,26.80,21095200],
      [-79,38.985481,-76.942626,26.80,21095200],
      [-69,38.985481,-76.942626,26.80,21095200],
      [-73,38.985481,-76.942626,26.80,21095200],
      [-75,38.985527,-76.942573,26.70,21095800],
      [-83,38.985527,-76.942573,26.70,21095800],
      [-73,38.985527,-76.942573,26.70,21095800],
      [-85,38.985565,-76.942558,26.70,21100200],
      [-80,38.985565,-76.942558,26.70,21100200],
      [-82,38.985591,-76.942550,26.60,21100500],
      [-73,38.985591,-76.942550,26.60,21100500],
      [-75,38.985591,-76.942550,26.60,21100500],
      [-69,38.985591,-76.942550,26.60,21100500],
      [-72,38.985645,-76.942550,26.20,21101000],
      [-70,38.985645,-76.942550,26.20,21101000],
      [-69,38.985645,-76.942550,26.20,21101000],
      [-71,38.985683,-76.942550,26.00,21101400],
      [-71,38.985683,-76.942550,26.00,21101400],
      [-73,38.985706,-76.942550,26.00,21101600],
      [-91,38.985706,-76.942550,26.00,21101600],
      [-81,38.985740,-76.942550,25.80,21101900],
      [-81,38.985740,-76.942550,25.80,21101900],
      [-81,38.985774,-76.942550,25.60,21102200],
      [-75,38.985774,-76.942550,25.60,21102200],
      [-83,38.985774,-76.942550,25.60,21102200],
      [-79,38.985774,-76.942550,25.60,21102200],
      [-73,38.985828,-76.942543,24.80,21102700],
      [-80,38.985828,-76.942543,24.80,21102700],
      [-71,38.985828,-76.942543,24.80,21102700],
      [-72,38.985828,-76.942543,24.80,21102700],
      [-75,38.985877,-76.942543,23.90,21103200],
      [-77,38.985877,-76.942543,23.90,21103200],
      [-77,38.985877,-76.942543,23.90,21103200],
      [-80,38.985877,-76.942543,23.90,21103200],
      [-88,38.985931,-76.942550,23.30,21103700],
      [-73,38.985931,-76.942550,23.30,21103700],
      [-80,38.985931,-76.942550,23.30,21103700],
      [-77,38.985931,-76.942550,23.30,21103700],
      [-72,38.985984,-76.942543,22.60,21104200],
      [-81,38.985984,-76.942543,22.60,21104200],
      [-75,38.985984,-76.942543,22.60,21104200],
      [-82,38.985984,-76.942543,22.60,21104200],
      [-61,38.986042,-76.942543,21.40,21104700],
      [-81,38.986042,-76.942543,21.40,21104700],
      [-73,38.986042,-76.942543,21.40,21104700],
      [-89,38.986042,-76.942543,21.40,21104700],
      [-85,38.986099,-76.942535,21.30,21105200],
      [-88,38.986099,-76.942535,21.30,21105200],
      [-87,38.986099,-76.942535,21.30,21105200],
      [-85,38.986099,-76.942535,21.30,21105200],
      [-80,38.986156,-76.942543,21.60,21105700],
      [-87,38.986156,-76.942543,21.60,21105700],
      [-88,38.986156,-76.942543,21.60,21105700],
      [-85,38.986156,-76.942543,21.60,21105700],
      [-86,38.986217,-76.942535,21.30,21110200],
      [-85,38.986217,-76.942535,21.30,21110200],
      [-83,38.986217,-76.942535,21.30,21110200],
      [-88,38.986255,-76.942543,21.30,21110500],
      [-77,38.986255,-76.942543,21.30,21110500],
      [-84,38.986286,-76.942543,22.50,21110800],
      [-76,38.986286,-76.942543,22.50,21110800],
      [-72,38.986286,-76.942543,22.50,21110800],
      [-74,38.986286,-76.942543,22.50,21110800],
      [-74,38.986351,-76.942550,25.10,21111300],
      [-74,38.986351,-76.942550,25.10,21111300],
      [-77,38.986351,-76.942550,25.10,21111300],
      [-72,38.986351,-76.942550,25.10,21111300],
      [-73,38.986396,-76.942558,28.00,21111800],
      [-76,38.986396,-76.942558,28.00,21111800],
      [-72,38.986396,-76.942558,28.00,21111800],
      [-83,38.986427,-76.942558,28.60,21112200],
      [-84,38.986427,-76.942558,28.60,21112200],
      [-86,38.986457,-76.942558,29.10,21112500],
      [-89,38.986457,-76.942558,29.10,21112500],
      [-89,38.986476,-76.942550,29.10,21112700],
      [-81,38.986476,-76.942550,29.10,21112700],
      [-68,38.986503,-76.942543,30.20,21113000],
      [-77,38.986503,-76.942543,30.20,21113000],
      [-70,38.986511,-76.942527,30.90,21113300],
      [-71,38.986511,-76.942527,30.90,21113300],
      [-70,38.986511,-76.942527,30.90,21113300],
      [-80,38.986511,-76.942527,30.90,21113300],
      [-75,38.986515,-76.942489,32.20,21113800],
      [-70,38.986515,-76.942489,32.20,21113800],
      [-79,38.986515,-76.942489,32.20,21113800],
      [-87,38.986515,-76.942489,32.20,21113800],
      [-86,38.986526,-76.942451,34.30,21114300],
      [-89,38.986526,-76.942451,34.30,21114300],
      [-81,38.986526,-76.942451,34.30,21114300],
      [-83,38.986530,-76.942413,35.00,21114700],
      [-80,38.986530,-76.942413,35.00,21114700],
      [-87,38.986530,-76.942413,35.00,21114700],
      [-76,38.986530,-76.942413,35.00,21114700],
      [-77,38.986518,-76.942359,35.50,21115200],
      [-76,38.986518,-76.942359,35.50,21115200],
      [-74,38.986518,-76.942359,35.50,21115200],
      [-85,38.986518,-76.942359,35.50,21115200],
      [-90,38.986473,-76.942344,35.60,21115700],
      [-84,38.986473,-76.942344,35.60,21115700],
      [-89,38.986473,-76.942344,35.60,21115700],
      [-82,38.986473,-76.942344,35.60,21115700],
      [-83,38.986434,-76.942337,36.80,21120200],
      [-70,38.986434,-76.942337,36.80,21120200],
      [-82,38.986434,-76.942337,36.80,21120200],
      [-71,38.986434,-76.942337,36.80,21120200],
      [-75,38.986381,-76.942321,37.80,21120700],
      [-71,38.986381,-76.942321,37.80,21120700],
      [-72,38.986366,-76.942314,37.80,21120900],
      [-80,38.986366,-76.942314,37.80,21120900],
      [-73,38.986328,-76.942306,38.50,21121200],
      [-82,38.986328,-76.942306,38.50,21121200],
      [-82,38.986297,-76.942298,38.80,21121500],
      [-76,38.986297,-76.942298,38.80,21121500],
      [-84,38.986297,-76.942298,38.80,21121500],
      [-86,38.986255,-76.942291,39.30,21121900],
      [-78,38.986255,-76.942291,39.30,21121900],
      [-78,38.986255,-76.942291,39.30,21121900],
      [-76,38.986213,-76.942283,39.80,21122300],
      [-78,38.986213,-76.942283,39.80,21122300],
      [-81,38.986213,-76.942283,39.80,21122300],
      [-86,38.986213,-76.942283,39.80,21122300],
      [-82,38.986164,-76.942276,40.20,21122800],
      [-82,38.986164,-76.942276,40.20,21122800],
      [-80,38.986164,-76.942276,40.20,21122800],
      [-81,38.986164,-76.942276,40.20,21122800],
      [-75,38.986118,-76.942268,40.50,21123300],
      [-80,38.986118,-76.942268,40.50,21123300],
      [-83,38.986118,-76.942268,40.50,21123300],
      [-78,38.986087,-76.942260,40.50,21123700],
      [-75,38.986087,-76.942260,40.50,21123700],
      [-72,38.986087,-76.942260,40.50,21123700],
      [-81,38.986087,-76.942260,40.50,21123700],
      [-83,38.986076,-76.942253,41.00,21124200],
      [-78,38.986076,-76.942253,41.00,21124200],
      [-85,38.986076,-76.942253,41.00,21124200],
      [-81,38.986076,-76.942253,41.00,21124200],
      [-79,38.986072,-76.942253,40.70,21124700],
      [-84,38.986072,-76.942253,40.70,21124700],
      [-89,38.986072,-76.942253,40.70,21124700],
      [-83,38.986072,-76.942253,40.70,21124700],
      [-79,38.986072,-76.942253,40.90,21125200],
      [-86,38.986072,-76.942253,40.90,21125200],
      [-91,38.986072,-76.942253,40.90,21125200],
      [-90,38.986072,-76.942253,40.90,21125200],
      [-88,38.986076,-76.942253,40.90,21125700],
      [-89,38.986076,-76.942253,40.90,21125700],
      [-86,38.986076,-76.942253,40.90,21125700],
      [-84,38.986076,-76.942253,40.90,21125700],
      [-85,38.986080,-76.942260,40.90,21130200],
      [-87,38.986080,-76.942260,40.90,21130200],
      [-81,38.986080,-76.942260,40.90,21130200],
      [-70,38.986080,-76.942260,40.90,21130200],
      [-76,38.986072,-76.942260,40.90,21130700],
      [-88,38.986072,-76.942260,40.90,21130700],
      [-88,38.986068,-76.942260,40.90,21130900],
      [-86,38.986068,-76.942260,40.90,21130900],
      [-83,38.986072,-76.942260,40.90,21131200],
      [-83,38.986072,-76.942260,40.90,21131200],
      [-84,38.986072,-76.942260,40.90,21131200],
      [-82,38.986072,-76.942260,40.90,21131200],
      [-85,38.986068,-76.942268,40.70,21131700],
      [-81,38.986068,-76.942268,40.70,21131700],
      [-83,38.986068,-76.942268,40.70,21131700],
      [-81,38.986064,-76.942276,40.70,21132000],
      [-84,38.986064,-76.942276,40.70,21132000],
      [-91,38.986049,-76.942291,39.90,21132300],
      [-86,38.986049,-76.942291,39.90,21132300],
      [-78,38.986049,-76.942291,39.90,21132300],
      [-86,38.986049,-76.942291,39.90,21132300],
      [-73,38.986000,-76.942283,39.60,21132800],
      [-80,38.986000,-76.942283,39.60,21132800],
      [-79,38.986000,-76.942283,39.60,21132800],
      [-72,38.985958,-76.942276,39.10,21133200],
      [-83,38.985958,-76.942276,39.10,21133200],
      [-79,38.985919,-76.942268,38.80,21133500],
      [-87,38.985919,-76.942268,38.80,21133500],
      [-80,38.985881,-76.942276,38.50,21133800],
      [-75,38.985881,-76.942276,38.50,21133800],
      [-77,38.985881,-76.942276,38.50,21133800],
      [-75,38.985881,-76.942276,38.50,21133800],
      [-81,38.985824,-76.942276,38.00,21134300],
      [-79,38.985824,-76.942276,38.00,21134300],
      [-77,38.985824,-76.942276,38.00,21134300],
      [-87,38.985824,-76.942276,38.00,21134300],
      [-86,38.985763,-76.942268,37.20,21134800],
      [-79,38.985763,-76.942268,37.20,21134800],
      [-86,38.985763,-76.942268,37.20,21134800],
      [-89,38.985763,-76.942268,37.20,21134800],
      [-89,38.985710,-76.942260,36.40,21135300],
      [-89,38.985710,-76.942260,36.40,21135300],
      [-81,38.985710,-76.942260,36.40,21135300],
      [-87,38.985664,-76.942253,35.80,21135700],
      [-88,38.985664,-76.942253,35.80,21135700],
      [-82,38.985664,-76.942253,35.80,21135700],
      [-81,38.985664,-76.942253,35.80,21135700],
      [-70,38.985607,-76.942245,34.80,21140200],
      [-82,38.985607,-76.942245,34.80,21140200],
      [-73,38.985607,-76.942245,34.80,21140200],
      [-70,38.985607,-76.942245,34.80,21140200],
      [-73,38.985561,-76.942237,34.00,21140700],
      [-77,38.985561,-76.942237,34.00,21140700],
      [-81,38.985561,-76.942237,34.00,21140700],
      [-89,38.985561,-76.942237,34.00,21140700],
      [-76,38.985519,-76.942230,33.00,21141200],
      [-75,38.985519,-76.942230,33.00,21141200],
      [-75,38.985500,-76.942222,33.00,21141400],
      [-84,38.985500,-76.942222,33.00,21141400],
      [-80,38.985485,-76.942192,32.10,21141700],
      [-86,38.985485,-76.942192,32.10,21141700],
      [-79,38.985485,-76.942192,32.10,21141700],
      [-77,38.985485,-76.942192,32.10,21141700],
      [-85,38.985485,-76.942192,32.10,21141700],
      [-80,38.985492,-76.942131,31.10,21142300],
      [-81,38.985492,-76.942131,31.10,21142300],
      [-85,38.985492,-76.942131,31.10,21142300],
      [-80,38.985492,-76.942131,31.10,21142300],
      [-84,38.985504,-76.942123,30.20,21142800],
      [-81,38.985504,-76.942123,30.20,21142800],
      [-80,38.985504,-76.942123,30.20,21142800],
      [-76,38.985504,-76.942123,30.20,21142800],
      [-80,38.985511,-76.942123,29.80,21143300],
      [-80,38.985511,-76.942123,29.80,21143300],
      [-80,38.985511,-76.942123,29.80,21143300],
      [-80,38.985534,-76.942115,29.60,21143700],
      [-80,38.985534,-76.942115,29.60,21143700],
      [-80,38.985549,-76.942115,29.60,21143900],
      [-80,38.985549,-76.942115,29.60,21143900],
      [-80,38.985576,-76.942108,29.20,21144200],
      [-80,38.985576,-76.942108,29.20,21144200],
      [-80,38.985614,-76.942108,28.70,21144500],
      [-80,38.985614,-76.942108,28.70,21144500],
      [-80,38.985614,-76.942108,28.70,21144500],
    ];

    var cleanData = [];
    _.each(data, function(d) {
      var upperLimit = 81;
      if (d[0]+upperLimit > 0) {
        // var LinearizedValue = 0.22;
        var LinearizedValue = (d[0] + upperLimit) / upperLimit;
      } else {
        var LinearizedValue = 0;
      }
      cleanData.push([ d[1], d[2], LinearizedValue ]);

      // var latlng = [ d[1], d[2] ];
      // var marker = L.marker(latlng,
      //     {title: "#" + d[0],
      //     opacity: 0.5} // Adjust the opacity
      //     ).addTo(map);
    });

    console.log(cleanData);

    var heat = L.heatLayer(cleanData, {radius: 100}).addTo(map);

    // // Zoom to user location
    // map.locate({ setView: true })
    map.setView(new L.LatLng( 38.985614,-76.942108 ), 13);

    // Notes for using included MarkCluster Package
    // var markers = new L.MarkerClusterGroup();
    // markers.addLayer(new L.Marker([51.5, -0.09]));
    // map.addLayer(markers);
  };
}
